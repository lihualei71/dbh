<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The dependence-adjusted Benjamini-Hochberg (BH) procedure and step-up procedures for fixed-design
homoscedastic Gaussian linear models — dBH_lm • dbh</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="The dependence-adjusted Benjamini-Hochberg (BH) procedure and step-up procedures for fixed-design
homoscedastic Gaussian linear models — dBH_lm" />
<meta property="og:description" content="dBH_lm computes the rejection set of \(dBH_\gamma(\alpha)\) and \(dBH^2_\gamma(\alpha)\), as well as
\(dSU_{\gamma, \Delta}(\alpha)\) and \(dSU^2_{\gamma, \Delta}(\alpha)\) a broad class of step-up procedures for
linear models \(y = X\beta + \epsilon\) where \(X\) is a fixed-design matrix and \(\epsilon\) has i.i.d.
components drawn from \(N(0, \sigma^2)\) for some unknonw variance \(\sigma^2\). dBH_lm can handle
both one-sided tests \(H_i: \beta_i \le 0\) or \(H_i: \beta_i \ge 0\), and two-sided tests \(H_i: \beta_i = 0\)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dbh</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The dependence-adjusted Benjamini-Hochberg (BH) procedure and step-up procedures for fixed-design
homoscedastic Gaussian linear models</h1>
    
    <div class="hidden name"><code>dBH_lm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>dBH_lm</code> computes the rejection set of \(dBH_\gamma(\alpha)\) and \(dBH^2_\gamma(\alpha)\), as well as
\(dSU_{\gamma, \Delta}(\alpha)\) and \(dSU^2_{\gamma, \Delta}(\alpha)\) a broad class of step-up procedures for
linear models \(y = X\beta + \epsilon\) where \(X\) is a fixed-design matrix and \(\epsilon\) has i.i.d.
components drawn from \(N(0, \sigma^2)\) for some unknonw variance \(\sigma^2\). <code>dBH_lm</code> can handle
both one-sided tests \(H_i: \beta_i \le 0\) or \(H_i: \beta_i \ge 0\), and two-sided tests \(H_i: \beta_i = 0\).</p>
    </div>

    <pre class="usage"><span class='fu'>dBH_lm</span><span class='op'>(</span>
  <span class='va'>y</span>,
  <span class='va'>X</span>,
  subset <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>,
  intercept <span class='op'>=</span> <span class='cn'>TRUE</span>,
  side <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"right"</span>, <span class='st'>"left"</span>, <span class='st'>"two"</span><span class='op'>)</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.05</span>,
  gamma <span class='op'>=</span> <span class='cn'>NULL</span>,
  tautype <span class='op'>=</span> <span class='st'>"QC"</span>,
  niter <span class='op'>=</span> <span class='fl'>1</span>,
  avals <span class='op'>=</span> <span class='cn'>NULL</span>,
  avals_type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"BH"</span>, <span class='st'>"geom"</span>, <span class='st'>"bonf"</span>, <span class='st'>"manual"</span><span class='op'>)</span>,
  geom_fac <span class='op'>=</span> <span class='fl'>2</span>,
  eps <span class='op'>=</span> <span class='fl'>0.05</span>,
  qcap <span class='op'>=</span> <span class='fl'>2</span>,
  gridsize <span class='op'>=</span> <span class='fl'>20</span>,
  exptcap <span class='op'>=</span> <span class='fl'>0.9</span>,
  is_safe <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>the outcome vector.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>the design matrix. The intercept term should be added manually into <code>X</code> to be included. See Details.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>a subset of <code>1:ncol(X)</code>, which specifies the subset of coefficients to be tested. The default is
<code>1:ncol(X)</code>, which tests all coefficients.</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>a logical indicating whether an intercept is included in the linear regression. By default,
the intercept term is not tested. If it needs to be tested together with other variables, manually add it into
<code>X</code> and set <code>intercept = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>side</th>
      <td><p>a string that takes values in {"right", "left", "two"}, with "right" for one-sided tests
\(H_i: \mu_i \le 0\), "left" for one-sided tests, \(H_i: \mu_i \ge 0\), and "two" for two-sided tests
\(H_i: \mu_i = 0\).</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>the target FDR level.</p></td>
    </tr>
    <tr>
      <th>gamma</th>
      <td><p>the parameter for the dBH and dSU procedures. The default is <code>NULL</code>, which gives dBY or the safe
dSU with gamma = 1 / Lm defined in Appendix C.1.</p></td>
    </tr>
    <tr>
      <th>tautype</th>
      <td><p>the type of tau function. In the current version, only "QC" (q-value-calibration) is supported with
\(\tau(c; X) = cR_{BH}(c) / m\).</p></td>
    </tr>
    <tr>
      <th>niter</th>
      <td><p>the number of iterations. In the current version it can only be 1, for dBH/dSU, or 2, for
\(dBH^2\)/\(dSU^2\).</p></td>
    </tr>
    <tr>
      <th>avals</th>
      <td><p>the a-values in the step-up procedures defined in Appendix C.1. The default is NULL, in which case
<code>avals</code> is determined by <code>avals_type</code>. See Details.</p></td>
    </tr>
    <tr>
      <th>avals_type</th>
      <td><p>a string that takes values in {"BH", "geom", "bonf", "manual"}, which determines the type of
thresholds in the step-up procedures. See Details.</p></td>
    </tr>
    <tr>
      <th>geom_fac</th>
      <td><p>a real number that is larger than 1. This is the growing rate of thresholds when
<code>avals_type = "geom"</code>. See Details.</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>a real number in [0, 1], which is used to determine \(t_{hi}\) discussed in Section 4.2.</p></td>
    </tr>
    <tr>
      <th>qcap</th>
      <td><p>a real number that is larger than 1. It is used to filter out hypotheses with q-values above
<code>qcap</code> X <code>alpha</code>, as discussed in Appendix C.2.2.</p></td>
    </tr>
    <tr>
      <th>gridsize</th>
      <td><p>an integer for the size of the grid used when <code>niter = 2</code>. For two-sided tests, <code>gridsize</code>
knots will be used for both the positive and negative sides.</p></td>
    </tr>
    <tr>
      <th>exptcap</th>
      <td><p>a real number in [0, 1]. It is used by \(dBH^2\)/\(dSU^2\) to filter out hypotheses with
\(g_i*(q_i | S_i)\) below <code>exptcap</code> X <code>alpha</code> / m in their initializations, as discussed in Appendix C.2.5.</p></td>
    </tr>
    <tr>
      <th>is_safe</th>
      <td><p>a logical or NULL indicating whether the procedure is taken as safe. DON'T set <code>is_safe = TRUE</code>
unless the covariance structure is known to be CPRDS. The default is <code>NULL</code>, which sets <code>is_safe = TRUE</code>
if <code>gamma = NULL</code> or <code>gamma</code> is below 1 / Lm, and <code>is_safe = FALSE</code> otherwise.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>a logical indicating whether a progress bar is shown.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with the following attributes</p><ul>
<li><p><code>rejs</code>: the indices of rejected hypotheses (after the randomized pruning step if any);</p></li>
<li><p><code>initrejs</code>: the indices of rejected hypotheses (before the randomized pruning step if any);</p></li>
<li><p><code>cand</code>: the set of candidate hypotheses for which \(g_i^{*}(q_i | S_i)\) is evaluated;</p></li>
<li><p><code>expt</code>: \(g_i^{*}(q_i | S_i)\) for each hypothesis in <code>cand</code>;</p></li>
<li><p><code>safe</code>: TRUE iff the procedure is safe;</p></li>
<li><p><code>secBH</code>: TRUE iff the randomzied pruning step (a.k.a. the secondary BH procedure) is invoked;</p></li>
<li><p><code>secBH_fac</code>: a vector that gives \(\hat{R}_i / R_{+}\) that is defined in Section 2.2. It only shows up
in the output if <code>secBH = TRUE</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>dBH_lm</code> can handle all dSU procedures that are defined in Appendix C.1. with
$$\Delta_{\alpha}(r) = \frac{\alpha a_{\ell}}{m}, r\in [a_{\ell}, a_{\ell + 1}), \ell = 0, 1, \ldots, L$$
for any set of integer a-values \(1\le a_1 &lt; \ldots &lt; a_L\le m\) (with \(a_0 = 0, a_{L+1} = m+1\)). There are two-ways to input the a-values.</p><ul>
<li><p>(Recommended) use <code>avals_type</code> while leave <code>avals</code> as its default. Three types of <code>avals_type</code>
are supported.</p><ul>
<li><p>When <code>avals_type = "BH"</code>, the BH procedure is used (i.e. \(a_\ell = \ell, \ell = 1, \ldots, m\));</p></li>
<li><p>When <code>avals_type = "geom"</code>, the geometrically increasing a-values that are defined in Appendix C.1.
are used with the growing rate specified by <code>geom_fac</code>, whose default is 2;</p></li>
<li><p>When <code>avals_type = "bonf"</code>, the Bonferroni procedure is used (i.e. \(a_1 = 1, L = 1\)).</p></li>
</ul></li>
<li><p>(Not recommended) use <code>avals</code> while set <code>avals_type = "manual"</code>. This option allows any set of
increasing a-values. However, it can be much slower than the recommended approach.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='dBH_mvgauss.html'>dBH_mvgauss</a></code>, <code><a href='dBH_mvt.html'>dBH_mvt</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Generate beta</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>150</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>beta1</span> <span class='op'>&lt;-</span> <span class='fl'>0.5</span>
<span class='va'>nalt</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
<span class='va'>beta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>beta1</span>, <span class='va'>nalt</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>p</span> <span class='op'>-</span> <span class='va'>nalt</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Generate X and y</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>*</span> <span class='va'>p</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>X</span> <span class='op'>%*%</span> <span class='va'>beta</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>

<span class='co'># Run dBH_1(\alpha) for one-sided tests</span>
<span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='fl'>0.05</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>dBH_lm</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>y</span>, X <span class='op'>=</span> <span class='va'>X</span>, side <span class='op'>=</span> <span class='st'>"right"</span>, alpha <span class='op'>=</span> <span class='va'>alpha</span>,
              gamma <span class='op'>=</span> <span class='fl'>1</span>, niter <span class='op'>=</span> <span class='fl'>1</span>, avals_type <span class='op'>=</span> <span class='st'>"BH"</span><span class='op'>)</span>

<span class='co'># Run dBH_1(\alpha) for two-sided tests</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>dBH_lm</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>y</span>, X <span class='op'>=</span> <span class='va'>X</span>, side <span class='op'>=</span> <span class='st'>"right"</span>, alpha <span class='op'>=</span> <span class='va'>alpha</span>,
              gamma <span class='op'>=</span> <span class='fl'>1</span>, niter <span class='op'>=</span> <span class='fl'>1</span>, avals_type <span class='op'>=</span> <span class='st'>"BH"</span><span class='op'>)</span> 

<span class='co'># Run dBH^2_1(\alpha) for one-sided tests</span>
<span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='fl'>0.05</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>dBH_lm</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>y</span>, X <span class='op'>=</span> <span class='va'>X</span>, side <span class='op'>=</span> <span class='st'>"right"</span>, alpha <span class='op'>=</span> <span class='va'>alpha</span>,
              gamma <span class='op'>=</span> <span class='fl'>1</span>, niter <span class='op'>=</span> <span class='fl'>2</span>, avals_type <span class='op'>=</span> <span class='st'>"BH"</span><span class='op'>)</span>

<span class='co'># Run dBH^2_1(\alpha) for one-sided tests</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>dBH_lm</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>y</span>, X <span class='op'>=</span> <span class='va'>X</span>, side <span class='op'>=</span> <span class='st'>"right"</span>, alpha <span class='op'>=</span> <span class='va'>alpha</span>,
              gamma <span class='op'>=</span> <span class='fl'>1</span>, niter <span class='op'>=</span> <span class='fl'>2</span>, avals_type <span class='op'>=</span> <span class='st'>"BH"</span><span class='op'>)</span>

<span class='co'># Run dSU_1(\alpha) with the geometrically increasing a-values for one-sided tests</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>dBH_lm</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>y</span>, X <span class='op'>=</span> <span class='va'>X</span>, side <span class='op'>=</span> <span class='st'>"right"</span>, alpha <span class='op'>=</span> <span class='va'>alpha</span>,
              gamma <span class='op'>=</span> <span class='fl'>1</span>, niter <span class='op'>=</span> <span class='fl'>1</span>, avals_type <span class='op'>=</span> <span class='st'>"geom"</span>,
              geom_fac <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>

<span class='co'># Run dBY(\alpha) for one-sided tests</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>dBH_lm</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>y</span>, X <span class='op'>=</span> <span class='va'>X</span>, side <span class='op'>=</span> <span class='st'>"right"</span>, alpha <span class='op'>=</span> <span class='va'>alpha</span>,
              gamma <span class='op'>=</span> <span class='cn'>NULL</span>, niter <span class='op'>=</span> <span class='fl'>1</span>, avals_type <span class='op'>=</span> <span class='st'>"BH"</span><span class='op'>)</span>

<span class='co'># Run dBY^2(\alpha) for one-sided tests</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>dBH_lm</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>y</span>, X <span class='op'>=</span> <span class='va'>X</span>, side <span class='op'>=</span> <span class='st'>"right"</span>, alpha <span class='op'>=</span> <span class='va'>alpha</span>,
              gamma <span class='op'>=</span> <span class='cn'>NULL</span>, niter <span class='op'>=</span> <span class='fl'>2</span>, avals_type <span class='op'>=</span> <span class='st'>"BH"</span><span class='op'>)</span>



</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Lihua Lei.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


